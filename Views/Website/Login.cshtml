@model EventShow.Models.User
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Login</title>
    <link href="../login/css/login.css" rel="stylesheet" type="text/css" />
</head>


<body style="background-color:rgb(182, 214, 207)">

    

    <div class="center imgw" style="display: flex; justify-content: center; ">

        <div class="center login">

            <h1>Login</h1>

            @using (Html.BeginForm())

            {

                @Html.AntiForgeryToken()

                <form>

                    <div class="txt_field">

                        @Html.TextBox("UserName", null, new { @class = "", @type = "text", required = "" })
                        <span> </span>
                        <label>Username</label>
                    </div>

                    <div class="txt_field">

                        @Html.TextBox("Password", null, new { @class = "", @type = "password", required = "" })
                        <span> </span>
                        <label>Password</label>
                    </div>



                    <input type="submit" value="Login" />

                    <div class="singup_Link">
                        <a href="@Url.Action("Register", "Website", new {})" style="color: #80b8a9 ">Sign Up</a>
                    </div>

                </form>
            }

        </div>
    </div>
    

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

    <script type="text/javascript">

        $("form").submit(function (e)
        {
            e.preventDefault();
            var $form = $(this);
            var data = $form.serialize();
            CheckLogin(data);
        });

        function CheckLogin(data) {
            $.ajax({
                type: "POST",
                url: '@Url.Action("Login", "Website")',
                data: data,
                success: function (response)
                {
                    {
                        if (response.success)
                        {
                            console.log(response)
                            window.localStorage.setItem("UserId", response.userId);
                            window.localStorage.setItem("UserName", response.userName);
                            window.location.href = '@Url.Action("Index", "Website", new {})';
                        }

                        else
                        {
                            if (response.useractive == false)
                            {
                                alert("Your account have been locked.")
                            }
                            else
                            {
                                alert("Login Failed!");
                            }
                            
                        }

                    }

                }
            });
        }

    </script>
    

</body>

</html>